<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Checklist de Campo - Relat√≥rio Fotogr√°fico (PGRSS)</title>
  
  <style>
:root{
  --bg: #0b1220;
  --card: #0f172a;
  --muted: #94a3b8;
  --text: #e2e8f0;
  --brand: #38bdf8;
  --brand-2:#34d399;
  --warn:#f59e0b;
  --danger:#ef4444;
  --radius: 14px;
  --shadow: 0 10px 30px rgba(2,6,23,.35);
  --ring: 0 0 0 3px rgba(56,189,248,.35);
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0; font:16px/1.5 system-ui,Segoe UI,Roboto,Arial,sans-serif; color:var(--text); background: radial-gradient(1200px 800px at 20% -10%, #0b1b35, transparent), var(--bg)}
.app-header{position:sticky; top:0; z-index:3; backdrop-filter: blur(8px); background: linear-gradient(180deg, rgba(2,6,23,.75), rgba(2,6,23,.35) 60%, transparent); padding:16px 16px 10px; border-bottom:1px solid rgba(148,163,184,.2)}
.app-header__title h1{margin:0 0 6px; font-size:clamp(18px,2.5vw,22px)}
.app-header__title p{margin:0; color:var(--muted); font-size:14px}
.header-actions{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px}
.btn{appearance:none; border:none; border-radius:999px; padding:10px 14px; cursor:pointer; color:#081018; background:#e2e8f0; font-weight:600; transition:transform .12s ease}
.btn:focus-visible{outline:none; box-shadow:var(--ring)}
.btn:hover{transform:translateY(-1px)}
.btn-primary{background:linear-gradient(135deg, #38bdf8, #22d3ee)}
.btn-secondary{background:#94a3b8}
.btn-success{background:linear-gradient(135deg, #34d399, #22c55e)}
.btn-neutral{background:#e5e7eb}
.btn-danger{background:linear-gradient(135deg, #f87171, #ef4444); color:#0b1220}
.btn-ghost{background:transparent; color:var(--text); border:1px dashed rgba(226,232,240,.25)}
.info-box,.lgpd-box{max-width:1100px; margin:14px auto; padding:14px; border-radius:var(--radius); background:linear-gradient(180deg, rgba(14,22,40,.8), rgba(14,22,40,.6)); border:1px solid rgba(148,163,184,.2)}
.info-box ol{margin:8px 0 0 18px}
.lgpd-box{color:#fef3c7; border-color:#f59e0b}
.progress{max-width:1100px; margin:12px auto}
.progress__bar{height:22px; background:#0b1220; border-radius:999px; overflow:hidden; border:1px solid rgba(148,163,184,.25)}
.progress__fill{height:100%; background:linear-gradient(90deg, #34d399, #38bdf8); display:flex; align-items:center; justify-content:center; font-weight:700}
.stats{display:flex; gap:12px; margin-top:10px; flex-wrap:wrap}
.stat{flex:1 1 140px; background:linear-gradient(180deg, rgba(14,22,40,.8), rgba(14,22,40,.6)); border:1px solid rgba(148,163,184,.2); border-radius:var(--radius); padding:10px; text-align:center}
.stat__number{font-size:24px; font-weight:800}
.stat__label{color:var(--muted); font-size:12px}
.content{max-width:1100px; margin:14px auto; display:grid; gap:12px}
.section{border:1px solid rgba(148,163,184,.25); border-radius:var(--radius); background:linear-gradient(180deg, rgba(14,22,40,.65), rgba(14,22,40,.5)); box-shadow:var(--shadow)}
.section__header{width:100%; background:linear-gradient(135deg, rgba(56,189,248,.2), rgba(34,197,94,.2)); padding:14px 16px; border:none; color:var(--text); border-radius:inherit; display:flex; align-items:center; justify-content:space-between; cursor:pointer}
.section__header:focus-visible{outline:none; box-shadow:var(--ring)}
.section__content{padding:14px; animation:fadeIn .2s ease both}
.badge{background:rgba(56,189,248,.2); border:1px solid rgba(56,189,248,.45); color:#a5f3fc; padding:2px 8px; border-radius:999px; font-size:11px}
.chevron{transition:transform .18s ease}
.subsection{border-left:3px solid rgba(56,189,248,.45); padding-left:12px; margin:8px 0 18px}
.subsection__desc{color:var(--muted); font-size:14px}
.photo-item{display:flex; gap:12px; background:rgba(2,6,23,.4); border:1px solid rgba(148,163,184,.2); border-radius:12px; padding:12px; margin:10px 0; transition:border-color .15s ease, background .2s}
.photo-item--checked{background:rgba(22,163,74,.15); border-color:rgba(34,197,94,.6)}
.photo-check__box{width:22px; height:22px; accent-color:#34d399}
.photo-details{flex:1}
.photo-title{display:flex; align-items:center; gap:8px; font-weight:700}
.photo-number{background:#38bdf8; color:#001018; padding:2px 10px; border-radius:999px; font-size:12px}
.photo-description{color:var(--muted); font-size:14px; margin:6px 0 10px}
.photo-actions{display:flex; gap:8px; flex-wrap:wrap; margin-bottom:8px}
.thumbs{list-style:none; padding:0; margin:0; display:grid; grid-template-columns:repeat(auto-fill, minmax(120px,1fr)); gap:10px}
.thumb{position:relative; padding:8px; border:1px solid rgba(148,163,184,.25); border-radius:10px; background:#0b1220; transition:transform .12s ease, border-color .12s ease; user-select:none}
.thumb[draggable="true"]{cursor:grab}
.thumb:focus-visible{outline:none; box-shadow:var(--ring)}
.thumb:hover{transform:translateY(-1px)}
.thumb__img{display:block; width:100%; height:90px; object-fit:cover; border-radius:8px; background:#0a0f1a}
.thumb__caption{margin-top:6px}
.thumb__caption input{width:100%; background:transparent; border:1px dashed rgba(148,163,184,.35); color:var(--text); border-radius:8px; padding:6px 8px; font-size:13px}
.thumb__buttons{display:flex; gap:6px; margin-top:6px}
.icon-btn{border:none; border-radius:8px; padding:6px 8px; cursor:pointer; background:#111827; color:#e5e7eb}
.icon-btn:hover{background:#0f172a}
.icon-btn--danger{background:#7f1d1d}
.app-footer{max-width:1100px; margin:24px auto 40px; text-align:center; color:var(--muted)}
.toast{position:fixed; left:50%; bottom:18px; transform:translateX(-50%); background:#0b1220; color:var(--text); border:1px solid rgba(148,163,184,.25); padding:10px 14px; border-radius:999px; box-shadow:var(--shadow); opacity:0; animation:toastIn .2s ease forwards}
@keyframes toastIn{to{opacity:1; transform:translateX(-50%) translateY(-2px)}}
@keyframes fadeIn{from{opacity:0; transform:translateY(-2px)} to{opacity:1; transform:none}}
@media (prefers-reduced-motion: reduce){*{animation:none!important; transition:none!important}}
@media print{body{background:white; color:#111827} .app-header, .info-box, .lgpd-box, .header-actions, .toast{display:none!important} .content{max-width:100%; margin:0} .section{break-inside:avoid; box-shadow:none; border-color:#cbd5e1} .thumb__img{height:80px} .thumb__caption input{border:none}}

</style>
  <meta name="theme-color" content="#0f172a">
</head>
<body>
  <header class="app-header">
    <div class="app-header__title">
      <h1>üì∏ CHECKLIST DE CAMPO - RELAT√ìRIO FOTOGR√ÅFICO</h1>
      <p>Cl√≠nica Dr. Cl√°udio Eul√°lio - Cirurgia Pl√°stica ‚Äî Sala 1701 - Diamond Center - Teresina/PI</p>
    </div>
    <div class="header-actions">
      <button id="btnExpandAll" class="btn btn-primary">üìÇ Expandir tudo</button>
      <button id="btnCollapseAll" class="btn btn-secondary">üìÅ Fechar tudo</button>
      <button id="btnPrint" class="btn btn-success">üñ®Ô∏è Imprimir</button>
      <button id="btnExport" class="btn btn-neutral">‚¨áÔ∏è Exportar JSON</button>
      <label class="btn btn-neutral">
        ‚¨ÜÔ∏è Importar JSON
        <input id="importInput" type="file" accept="application/json" hidden>
      </label>
      <button id="btnClear" class="btn btn-danger">üßπ Limpar dados</button>
    </div>
  </header>

  <section class="info-box" role="note" aria-label="Instru√ß√µes de Uso">
    <h3>üìã Instru√ß√µes de Uso</h3>
    <ol>
      <li>Abra no celular/tablet durante a visita.</li>
      <li>Marque cada item ap√≥s fotografar.</li>
      <li>Use as notas por se√ß√£o para observa√ß√µes.</li>
      <li>Acompanhe o progresso abaixo.</li>
      <li>‚≠ê = Item cr√≠tico (n√£o pode faltar).</li>
    </ol>
  </section>

  <section class="lgpd-box" role="note" aria-label="Aviso LGPD">
    ‚ö†Ô∏è <strong>LGPD:</strong> N√£o captar rostos de pacientes nem dados identific√°veis. Evite documentos pessoais e dados sens√≠veis em fotos.
  </section>

  <section class="progress">
    <div class="progress__bar" aria-label="Progresso do checklist" aria-live="polite">
      <div id="progressFill" class="progress__fill" style="width:0%">0%</div>
    </div>
    <div class="stats">
      <div class="stat"><div class="stat__number" id="statPhotos">0</div><div class="stat__label">Fotos confirmadas</div></div>
      <div class="stat"><div class="stat__number" id="statItems">‚Äî</div><div class="stat__label">Total de itens</div></div>
      <div class="stat"><div class="stat__number" id="statCritical">0/0</div><div class="stat__label">Cr√≠ticos ‚≠ê</div></div>
    </div>
  </section>

  <main id="content" class="content">
    <section class="section" data-section-id="sec-1">
<button class="section__header" type="button" aria-expanded="false" aria-controls="sec-1-content">
  <h2>üè¢ 1. FACHADA E ACESSO EXTERNO 3 fotos</h2>
  <span class="chevron" aria-hidden="true">‚ñº</span>
</button>
<div id="sec-1-content" class="section__content" hidden>

<div class="subsection">
<h3>1.1. Fachada do Edif√≠cio Diamond Center</h3>
<div class="subsection-description">
                        üìç <strong>Local:</strong> Av. Universit√°ria, 750 - tire da cal√ßada em frente<br/>
                        üéØ <strong>Objetivo:</strong> Localizar geograficamente o estabelecimento
                    </div>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 01</span>
                                Vista externa do pr√©dio Diamond Center
                            </div>
<div class="photo-description">
                                ‚úì Fachada completa do edif√≠cio<br/>
                                ‚úì Letreiro "Diamond Center" vis√≠vel<br/>
                                ‚úì Contexto urbano da localiza√ß√£o
                            </div>
<div class="photo-tips">
                                üí° Dica: Tire da cal√ßada oposta (10-15 metros). Modo horizontal (paisagem)
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 02</span>
                                Entrada da cl√≠nica - Sala 1701
                            </div>
<div class="photo-description">
                                ‚úì Porta com n√∫mero "1701" bem vis√≠vel<br/>
                                ‚úì Acesso ao 17¬∫ andar
                            </div>
<div class="photo-tips">
                                üí° Dica: 2-3 metros de dist√¢ncia. Certifique-se que o n√∫mero aparece claramente
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 03</span>
                                Placa de identifica√ß√£o do m√©dico
                            </div>
<div class="photo-description">
                                ‚úì Placa "Dr. Cl√°udio Eul√°lio - Cirurgia Pl√°stica"<br/>
                                ‚úì Identifica√ß√£o completa e leg√≠vel
                            </div>
<div class="photo-tips">
                                üí° Dica: Close (0,5-1 metro). Evite reflexos no vidro/acr√≠lico
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<textarea class="notes-area" placeholder="üìù Notas e observa√ß√µes desta se√ß√£o..."></textarea>
</div>

</div>
</section><section class="section" data-section-id="sec-2">
<button class="section__header" type="button" aria-expanded="false" aria-controls="sec-2-content">
  <h2>üõãÔ∏è 2. RECEP√á√ÉO E SALA DE ESPERA 2 fotos</h2>
  <span class="chevron" aria-hidden="true">‚ñº</span>
</button>
<div id="sec-2-content" class="section__content" hidden>

<div class="subsection">
<h3>2.1. √Årea de Recep√ß√£o</h3>
<div class="subsection-description">
                        üìç <strong>Local:</strong> Primeiro ambiente ap√≥s entrada<br/>
                        üéØ <strong>Objetivo:</strong> Documentar √°rea administrativa e organiza√ß√£o
                    </div>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 04</span>
                                Balc√£o de recep√ß√£o (vis√£o geral)
                            </div>
<div class="photo-description">
                                ‚úì Balc√£o completo<br/>
                                ‚úì Computador e √°rea de trabalho<br/>
                                ‚úì Organiza√ß√£o geral
                            </div>
<div class="photo-tips">
                                üí° Dica: Posicione-se de frente para o balc√£o. Foto ampla pegando todo o ambiente
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 05</span>
                                Sala de espera
                            </div>
<div class="photo-description">
                                ‚úì Poltronas/cadeiras para pacientes<br/>
                                ‚úì TV ou elementos de conforto (se houver)<br/>
                                ‚úì Ambiente organizado e limpo
                            </div>
<div class="photo-tips">
                                üí° Dica: N√ÉO fotografe pacientes! Se houver algu√©m esperando, agende hor√°rio com menos movimento
                            </div>
<div class="alert-danger">
                                ‚ö†Ô∏è <strong>ATEN√á√ÉO:</strong> N√£o fotografar pacientes ou pessoas identific√°veis (privacidade/LGPD)
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<textarea class="notes-area" placeholder="üìù Notas e observa√ß√µes desta se√ß√£o..."></textarea>
</div>

</div>
</section><section class="section" data-section-id="sec-3">
<button class="section__header" type="button" aria-expanded="false" aria-controls="sec-3-content">
  <h2>ü©∫ 3. CONSULT√ìRIO M√âDICO 1 foto</h2>
  <span class="chevron" aria-hidden="true">‚ñº</span>
</button>
<div id="sec-3-content" class="section__content" hidden>

<div class="subsection">
<h3>3.1. Sala de Consulta</h3>
<div class="subsection-description">
                        üìç <strong>Local:</strong> Ambiente para consultas e avalia√ß√µes<br/>
                        üéØ <strong>Objetivo:</strong> Documentar √°rea de atendimento cl√≠nico
                    </div>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 06</span>
                                Consult√≥rio (vis√£o geral)
                            </div>
<div class="photo-description">
                                ‚úì Mesa do m√©dico e cadeiras<br/>
                                ‚úì Maca de exame (se houver)<br/>
                                ‚úì Organiza√ß√£o geral do ambiente
                            </div>
<div class="photo-tips">
                                üí° Dica: Tire de um canto da sala (pega mais √°rea). Evite documentos com dados de pacientes vis√≠veis
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<textarea class="notes-area" placeholder="üìù Notas e observa√ß√µes desta se√ß√£o..."></textarea>
</div>

</div>
</section><section class="section" data-section-id="sec-4">
<button class="section__header" type="button" aria-expanded="false" aria-controls="sec-4-content">
  <h2>‚öïÔ∏è 4. SALA DE PROCEDIMENTOS 4 fotos</h2>
  <span class="chevron" aria-hidden="true">‚ñº</span>
</button>
<div id="sec-4-content" class="section__content" hidden>

<div class="critical-note">
<strong>‚≠ê √ÅREA IMPORTANTE!</strong> Esta sala √© onde acontecem os procedimentos cir√∫rgicos ambulatoriais. Fotografe com aten√ß√£o aos detalhes t√©cnicos.
                </div>
<div class="subsection">
<h3>4.1. Infraestrutura da Sala</h3>
<div class="subsection-description">
                        üìç <strong>Procedimentos realizados:</strong> Botox, preenchimentos, lipoaspira√ß√£o ambulatorial, pequenas suturas, retirada de pontos<br/>
                        üéØ <strong>Objetivo:</strong> Documentar capacidade t√©cnica e infraestrutura
                    </div>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 07</span>
                                Sala de procedimentos (vis√£o geral)
                            </div>
<div class="photo-description">
                                ‚úì Vista ampla mostrando TODA a sala<br/>
                                ‚úì Maca el√©trica posicionada<br/>
                                ‚úì Foco cir√∫rgico<br/>
                                ‚úì Arm√°rios e bancada<br/>
                                ‚úì <strong>Coletores de res√≠duos vis√≠veis</strong>
</div>
<div class="photo-tips">
                                üí° Dica: Tire de uma quina da sala (diagonal). Acenda todas as luzes. Inclua os coletores de lixo no enquadramento!
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 08</span>
                                Maca el√©trica e foco cir√∫rgico
                            </div>
<div class="photo-description">
                                ‚úì Maca ajust√°vel completa<br/>
                                ‚úì Foco de luz posicionado<br/>
                                ‚úì Estado de conserva√ß√£o dos equipamentos
                            </div>
<div class="photo-tips">
                                üí° Dica: Mostre que equipamentos est√£o em bom estado e funcionais
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 09</span>
                                Arm√°rios de materiais
                            </div>
<div class="photo-description">
                                ‚úì Arm√°rios para materiais est√©reis<br/>
                                ‚úì Organiza√ß√£o externa (limpeza)<br/>
                                ‚úì Fechados ou abertos (se autorizarem)
                            </div>
<div class="photo-tips">
                                üí° Dica: Pergunte se pode fotografar interior. Se n√£o, fotografe apenas fechado mostrando organiza√ß√£o
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 10</span>
                                Bancada com pia
                            </div>
<div class="photo-description">
                                ‚úì Pia para higieniza√ß√£o de m√£os<br/>
                                ‚úì Torneira (verificar se tem acionamento por pedal - √© um plus!)<br/>
                                ‚úì Sab√£o l√≠quido/antiss√©ptico<br/>
                                ‚úì Papel toalha<br/>
                                ‚úì Bancada limpa
                            </div>
<div class="photo-tips">
                                üí° Dica: Se torneira for com pedal, tire foto close! √â um diferencial positivo
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<textarea class="notes-area" placeholder="üìù Notas: estado dos equipamentos, organiza√ß√£o, limpeza..."></textarea>
</div>

</div>
</section><section class="section" data-section-id="sec-5">
<button class="section__header" type="button" aria-expanded="false" aria-controls="sec-5-content">
  <h2>‚ôªÔ∏è 5. SISTEMA DE RES√çDUOS - SALA DE PROCEDIMENTOS ‚≠ê‚≠ê‚≠ê 5 fotos</h2>
  <span class="chevron" aria-hidden="true">‚ñº</span>
</button>
<div id="sec-5-content" class="section__content" hidden>

<div class="alert-danger">
<strong>üö® SE√á√ÉO CR√çTICA - PRIORIDADE M√ÅXIMA!</strong><br/>
                    Esta √© a parte MAIS IMPORTANTE do relat√≥rio fotogr√°fico. Fotografe com m√°xima aten√ß√£o aos detalhes. Tire m√∫ltiplas fotos de cada coletor (depois escolhe a melhor).
                </div>
<div class="subsection">
<h3>5.1. Coletor de RES√çDUO INFECTANTE (Grupo A) ‚ò£Ô∏è</h3>
<div class="subsection-description">
<strong>O que vai neste coletor:</strong> Gazes com sangue, luvas usadas em procedimentos, compressas sujas, tecido adiposo de lipoaspira√ß√£o<br/>
<strong>Base legal:</strong> RDC 222/2018, Art. 13-15
                    </div>
<div class="photo-item">
<input onchange="updateProgress(this, true)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 11</span>
                                ‚≠ê Coletor Grupo A - Vista Geral
                            </div>
<div class="photo-description">
<strong>VERIFICAR e FOTOGRAFAR:</strong><br/>
                                ‚úì Saco cor BRANCA LEITOSA (ou vermelha)<br/>
                                ‚úì S√≠mbolo de risco biol√≥gico ‚ò£Ô∏è VIS√çVEL<br/>
                                ‚úì Lixeira com tampa (de prefer√™ncia com pedal)<br/>
                                ‚úì N√≠vel de preenchimento (m√°ximo 2/3 da capacidade)<br/>
                                ‚úì Lixeira completa (base at√© tampa)
                            </div>
<div class="photo-tips">
                                üí° Dica: Dist√¢ncia 1-2 metros. Foto deve mostrar lixeira inteira. Acenda luz se necess√°rio
                            </div>
<div class="critical-note">
<strong>‚ö†Ô∏è AN√ÅLISE CR√çTICA:</strong><br/>
                                ‚Ä¢ S√≠mbolo √© IMPRESSO no saco? (correto) ou √© adesivo? (incorreto)<br/>
                                ‚Ä¢ Saco est√° muito cheio? (acima de 2/3 = n√£o conforme)<br/>
                                ‚Ä¢ Tem pedal de acionamento? (positivo para relat√≥rio)
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<div class="photo-item">
<input onchange="updateProgress(this, true)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 12</span>
                                ‚≠ê Grupo A - Close no S√≠mbolo
                            </div>
<div class="photo-description">
<strong>FOTO CLOSE (30-50 cm):</strong><br/>
                                ‚úì S√≠mbolo de risco biol√≥gico ‚ò£Ô∏è bem n√≠tido<br/>
                                ‚úì Verificar se √© IMPRESSO (correto) ou adesivo (incorreto)<br/>
                                ‚úì Inscri√ß√£o "INFECTANTE" ou "RES√çDUO INFECTANTE" (se tiver)
                            </div>
<div class="photo-tips">
                                üí° Dica: Chegue bem perto! Foto deve ficar leg√≠vel. Este detalhe √© FUNDAMENTAL para an√°lise
                            </div>
<div class="alert-danger">
<strong>ATEN√á√ÉO:</strong> Se o s√≠mbolo for ADESIVO (colado depois), isso √© N√ÉO CONFORMIDADE! Anote para mencionar no relat√≥rio.
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
</div>
<div class="subsection">
<h3>5.2. Coletor de RES√çDUO COMUM (Grupo D) üóëÔ∏è</h3>
<div class="subsection-description">
<strong>O que vai neste coletor:</strong> Papel de embalagens limpas, pl√°sticos sem contato com paciente, papel toalha do banheiro<br/>
<strong>Regra de ouro:</strong> SEM contato com sangue ou fluidos = Grupo D
                    </div>
<div class="photo-item">
<input onchange="updateProgress(this, true)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 13</span>
                                ‚≠ê Coletor Grupo D - Res√≠duo Comum
                            </div>
<div class="photo-description">
<strong>VERIFICAR e FOTOGRAFAR:</strong><br/>
                                ‚úì Saco cor PRETA, CINZA ou colorido (coleta seletiva)<br/>
                                ‚úì SEM s√≠mbolo de risco biol√≥gico<br/>
                                ‚úì Lixeira SEPARADA do infectante (n√£o pode estar junto!)<br/>
                                ‚úì Verificar que N√ÉO h√° mistura de res√≠duos
                            </div>
<div class="photo-tips">
                                üí° Dica: Mostre que as duas lixeiras est√£o claramente separadas (uma do lado da outra, mas distintas)
                            </div>
<div class="alert-danger">
<strong>N√ÉO CONFORMIDADE GRAVE:</strong> Se houver res√≠duos infectantes (gazes sujas, luvas) no lixo comum = MISTURA PROIBIDA! Fotografe e anote!
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
</div>
<div class="subsection">
<h3>5.3. Coletor de PERFUROCORTANTES (Grupo E) üíâ‚≠ê‚≠ê‚≠ê</h3>
<div class="subsection-description">
<strong>O que vai neste coletor:</strong> Agulhas (hipod√©rmicas, sutura), l√¢minas de bisturi, scalps, ampolas de vidro quebradas<br/>
<strong>Base legal:</strong> RDC 222/2018, Art. 86-89
                    </div>
<div class="alert-danger">
<strong>üö® ITEM SUPER CR√çTICO!</strong> O coletor de perfurocortantes √© um dos pontos mais fiscalizados. Fotografe com m√°xima aten√ß√£o!<br/>
<strong>‚ö†Ô∏è NUNCA fotografe o coletor ABERTO! Risco de acidente!</strong>
</div>
<div class="photo-item">
<input onchange="updateProgress(this, true)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 14</span>
                                ‚≠ê‚≠ê‚≠ê Perfurocortante - Vista Geral FECHADO
                            </div>
<div class="photo-description">
<strong>CARACTER√çSTICAS OBRIGAT√ìRIAS:</strong><br/>
                                ‚úì COR AMARELA (obrigat√≥rio pela norma!)<br/>
                                ‚úì Material R√çGIDO (papel√£o r√≠gido ou pl√°stico)<br/>
                                ‚úì TAMPA BEM FECHADA (verificar veda√ß√£o!)<br/>
                                ‚úì Sem perfura√ß√µes ou avarias<br/>
                                ‚úì N√≠vel de preenchimento at√© 2/3 da capacidade<br/>
                                ‚úì Localizado pr√≥ximo ao ponto de uso
                            </div>
<div class="photo-tips">
                                üí° Dica: Dist√¢ncia 0,5-1 metro. Mostre coletor completo. Verifique visualmente se a tampa est√° bem vedada!
                            </div>
<div class="critical-note">
<strong>PONTOS CR√çTICOS DE AN√ÅLISE:</strong><br/>
                                ‚Ä¢ Tampa est√° realmente fechada? (se aberta = N√ÉO CONFORME GRAVE!)<br/>
                                ‚Ä¢ Coletor muito cheio? (acima de 2/3 = trocar imediatamente)<br/>
                                ‚Ä¢ Cor amarela bem vis√≠vel? (obrigat√≥rio)<br/>
                                ‚Ä¢ H√° sinais de vazamento ou perfura√ß√£o? (grave se houver)
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<div class="photo-item">
<input onchange="updateProgress(this, true)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 15</span>
                                ‚≠ê‚≠ê‚≠ê Perfurocortante - Close na Identifica√ß√£o
                            </div>
<div class="photo-description">
<strong>ETIQUETA DEVE CONTER:</strong><br/>
                                ‚úì S√≠mbolo de risco biol√≥gico ‚ò£Ô∏è<br/>
                                ‚úì Inscri√ß√£o "PERFUROCORTANTE"<br/>
                                ‚úì Identifica√ß√£o do local: "SALA 1701"<br/>
                                ‚úì Capacidade do coletor (ex: 7 litros)<br/>
                                ‚úì Linha de preenchimento m√°ximo (2/3)<br/>
                                ‚úì Data de in√≠cio do uso (se tiver)<br/>
                                ‚úì Inscri√ß√£o "N√ÉO ESVAZIAR" ou "N√ÉO REAPROVEITAR"
                            </div>
<div class="photo-tips">
                                üí° Dica: FOTO BEM DE PERTO (20-30 cm). Deve ficar 100% leg√≠vel! Esta foto √© essencial para an√°lise de conformidade.
                            </div>
<div class="alert-danger">
<strong>SE FALTAR ALGUMA INFORMA√á√ÉO NA ETIQUETA:</strong> √â n√£o conformidade! Anote tudo que est√° faltando para mencionar no relat√≥rio.
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
</div>
<textarea class="notes-area" placeholder="üìù NOTAS CR√çTICAS: S√≠mbolos impressos ou adesivos? N√≠veis de preenchimento? Segrega√ß√£o correta? Tampa do perfurocortante bem vedada? Observa√ß√µes importantes..."></textarea>

</div>
</section><section class="section" data-section-id="sec-6">
<button class="section__header" type="button" aria-expanded="false" aria-controls="sec-6-content">
  <h2>üßº 6. EXPURGO (SALA DE UTILIDADES) 3 fotos</h2>
  <span class="chevron" aria-hidden="true">‚ñº</span>
</button>
<div id="sec-6-content" class="section__content" hidden>

<div class="critical-note">
<strong>‚≠ê IMPORTANTE!</strong> Expurgo √© √°rea cr√≠tica para higieniza√ß√£o. Deve estar limpo e organizado.
                </div>
<div class="subsection">
<h3>6.1. Ambiente de Limpeza</h3>
<div class="subsection-description">
                        üìç <strong>Fun√ß√£o:</strong> Limpeza de instrumentais, higieniza√ß√£o de materiais, preparo de solu√ß√µes<br/>
                        üéØ <strong>Objetivo:</strong> Comprovar ambiente exclusivo para √°rea "suja"
                    </div>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 16</span>
                                Porta do expurgo
                            </div>
<div class="photo-description">
                                ‚úì Porta com identifica√ß√£o "EXPURGO" ou "SALA DE UTILIDADES"<br/>
                                ‚úì Placa vis√≠vel
                            </div>
<div class="photo-tips">
                                üí° Dica: Foto da porta externa. Identifica√ß√£o deve estar leg√≠vel
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 17</span>
                                Expurgo (vis√£o geral interna)
                            </div>
<div class="photo-description">
                                ‚úì Interior mostrando pia<br/>
                                ‚úì Prateleiras para produtos<br/>
                                ‚úì Produtos de limpeza organizados<br/>
                                ‚úì Ambiente limpo e organizado
                            </div>
<div class="photo-tips">
                                üí° Dica: Vista ampla do interior. Ambiente deve estar arrumado na hora da foto
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<div class="photo-item">
<input onchange="updateProgress(this, true)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 18</span>
                                ‚≠ê Pia do expurgo (detalhe)
                            </div>
<div class="photo-description">
                                ‚úì Close na pia e torneira<br/>
                                ‚úì <strong>OBSERVAR: Tipo de torneira:</strong><br/>
                                  ‚Üí Com acionamento por pedal (√ìTIMO - mencione no relat√≥rio!)<br/>
                                  ‚Üí Alavanca √∫nica (BOM)<br/>
                                  ‚Üí Manual comum (ACEIT√ÅVEL)<br/>
                                ‚úì Presen√ßa de sab√£o<br/>
                                ‚úì Estado de conserva√ß√£o
                            </div>
<div class="photo-tips">
                                üí° Dica: Se torneira for com pedal, destaque isso no relat√≥rio! √â um ponto muito positivo.
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<textarea class="notes-area" placeholder="üìù Notas: tipo de torneira, organiza√ß√£o, produtos vencidos (se houver), limpeza..."></textarea>
</div>

</div>
</section><section class="section" data-section-id="sec-7">
<button class="section__header" type="button" aria-expanded="false" aria-controls="sec-7-content">
  <h2>üöΩ 7. BANHEIROS 1-2 fotos</h2>
  <span class="chevron" aria-hidden="true">‚ñº</span>
</button>
<div id="sec-7-content" class="section__content" hidden>

<div class="subsection">
<h3>7.1. Instala√ß√µes Sanit√°rias</h3>
<div class="subsection-description">
                        üìç <strong>Segundo PGRSS:</strong> Cl√≠nica tem 2 banheiros<br/>
                        üéØ <strong>Objetivo:</strong> Documentar instala√ß√µes sanit√°rias adequadas
                    </div>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 19</span>
                                Banheiro (vis√£o geral)
                            </div>
<div class="photo-description">
                                ‚úì Vaso sanit√°rio<br/>
                                ‚úì Pia<br/>
                                ‚úì Revestimento cer√¢mico<br/>
                                ‚úì Limpeza e conserva√ß√£o
                            </div>
<div class="photo-tips">
                                üí° Dica: Fotografe com banheiro limpo! Se tiver 2 banheiros diferentes, tire 1 foto de cada.
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<textarea class="notes-area" placeholder="üìù Notas: condi√ß√µes de limpeza, funcionamento, ventila√ß√£o..."></textarea>
</div>

</div>
</section><section class="section" data-section-id="sec-8">
<button class="section__header" type="button" aria-expanded="false" aria-controls="sec-8-content">
  <h2>üì¶ 8. ARMAZENAMENTO TEMPOR√ÅRIO - 17¬∫ ANDAR ‚≠ê‚≠ê 3 fotos</h2>
  <span class="chevron" aria-hidden="true">‚ñº</span>
</button>
<div id="sec-8-content" class="section__content" hidden>

<div class="alert-danger">
<strong>üö® √ÅREA MUITO IMPORTANTE!</strong><br/>
                    Segundo o PGRSS, os res√≠duos RSS (Grupo A/E) ficam armazenados no 17¬∫ andar at√© coleta MENSAL pela NATUS Ambiental.<br/>
<strong>A BOMBONA AZUL DEVE ESTAR HERMETICAMENTE FECHADA!</strong>
</div>
<div class="subsection">
<h3>8.1. Local de Armazenamento no Pavimento</h3>
<div class="subsection-description">
                        üìç <strong>Local:</strong> √Årea pr√≥xima √† sala 1701 (mesmo andar)<br/>
                        üéØ <strong>Objetivo:</strong> Documentar armazenamento provis√≥rio at√© coleta mensal
                    </div>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 20</span>
                                Porta/√°rea do armazenamento tempor√°rio
                            </div>
<div class="photo-description">
                                ‚úì Entrada do local<br/>
                                ‚úì Identifica√ß√£o (se houver)<br/>
                                ‚úì Localiza√ß√£o no 17¬∫ andar
                            </div>
<div class="photo-tips">
                                üí° Dica: Pode ser uma sala, um quartinho ou √°rea espec√≠fica no corredor do andar
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<div class="photo-item">
<input onchange="updateProgress(this, true)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 21</span>
                                ‚≠ê‚≠ê‚≠ê BOMBONA AZUL 50L - HERMETICAMENTE FECHADA
                            </div>
<div class="photo-description">
<strong>ESTA √â UMA DAS FOTOS MAIS CR√çTICAS!</strong><br/><br/>
<strong>VERIFICAR E FOTOGRAFAR:</strong><br/>
                                ‚úì Cor AZUL bem vis√≠vel (50 litros)<br/>
                                ‚úì <strong>TAMPA HERMETICAMENTE FECHADA</strong> (CR√çTICO!)<br/>
                                ‚úì Etiqueta: "LIXO INFECTANTE - SALA 1701"<br/>
                                ‚úì S√≠mbolo de risco biol√≥gico ‚ò£Ô∏è<br/>
                                ‚úì Estado de conserva√ß√£o da bombona<br/>
                                ‚úì Sem vazamentos ou avarias
                            </div>
<div class="photo-tips">
                                üí° Dica: Dist√¢ncia 0,5-1 metro. Foto deve mostrar CLARAMENTE que a tampa est√° bem vedada!
                            </div>
<div class="alert-danger">
<strong>‚ö†Ô∏è N√ÉO CONFORMIDADE GRAV√çSSIMA:</strong><br/>
                                Se a bombona estiver ABERTA ou MAL VEDADA = RISCO DE CONTAMINA√á√ÉO!<br/>
                                Se encontrar assim, fotografe (√© prova) e RECOMENDE FECHAMENTO IMEDIATO no relat√≥rio!<br/><br/>
<strong>Pergunte ao respons√°vel:</strong> "A bombona est√° bem fechada? Posso verificar a veda√ß√£o?"
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 22</span>
                                Lixeira de res√≠duo comum (se houver no local)
                            </div>
<div class="photo-description">
                                ‚úì Lixeira com saco preto (Grupo D)<br/>
                                ‚úì Separada do infectante<br/>
                                ‚úì Sem mistura
                            </div>
<div class="photo-tips">
                                üí° Dica: Mostrar que h√° segrega√ß√£o tamb√©m no armazenamento tempor√°rio
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<textarea class="notes-area" placeholder="üìù NOTAS CR√çTICAS: Bombona bem fechada? Estado de veda√ß√£o? Etiqueta leg√≠vel? Organiza√ß√£o do local? Observa√ß√µes..."></textarea>
</div>

</div>
</section><section class="section" data-section-id="sec-9">
<button class="section__header" type="button" aria-expanded="false" aria-controls="sec-9-content">
  <h2>üè¢ 9. ARMAZENAMENTO EXTERNO - T√âRREO ‚≠ê‚≠ê‚≠ê 7 fotos</h2>
  <span class="chevron" aria-hidden="true">‚ñº</span>
</button>
<div id="sec-9-content" class="section__content" hidden>

<div class="alert-danger">
<strong>üö® SE√á√ÉO CR√çTICA - SUPER IMPORTANTE!</strong><br/>
                    O abrigo externo √© uma das √°reas mais fiscalizadas. Tire muitas fotos e observe TODOS os detalhes!<br/><br/>
<strong>Segundo PGRSS:</strong><br/>
                    ‚Ä¢ Abrigo no t√©rreo do Diamond Center<br/>
                    ‚Ä¢ 2 √°reas separadas: RSS e Res√≠duo Comum<br/>
                    ‚Ä¢ Acesso externo pela Rua Mios√≥tis
                </div>
<div class="subsection">
<h3>9.1. Acesso Externo</h3>
<div class="subsection-description">
                        üìç <strong>Local:</strong> Rua Mios√≥tis (lateral do edif√≠cio)<br/>
                        üéØ <strong>Objetivo:</strong> Documentar acesso para coleta externa
                    </div>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 23</span>
                                Port√£o de acesso - Rua Mios√≥tis
                            </div>
<div class="photo-description">
                                ‚úì Vista externa da Rua Mios√≥tis<br/>
                                ‚úì Port√£o onde caminh√£o coletor para<br/>
                                ‚úì Acesso facilitado para ve√≠culos
                            </div>
<div class="photo-tips">
                                üí° Dica: Tire da cal√ßada mostrando port√£o e acesso
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
</div>
<div class="subsection">
<h3>9.2. Entrada Interna do Abrigo</h3>
<div class="photo-item">
<input onchange="updateProgress(this, true)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 24</span>
                                ‚≠ê Porta interna do abrigo
                            </div>
<div class="photo-description">
                                ‚úì Porta vista de dentro do edif√≠cio (t√©rreo)<br/>
                                ‚úì Identifica√ß√£o: "LIXO" ou "RES√çDUOS" ou "ABRIGO DE RES√çDUOS"<br/>
                                ‚úì S√≠mbolo de risco biol√≥gico (se houver)
                            </div>
<div class="photo-tips">
                                üí° Dica: Foto da entrada mostrando identifica√ß√£o clara
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
</div>
<div class="subsection">
<h3>9.3. Interior do Abrigo - √ÅREA CR√çTICA!</h3>
<div class="photo-item">
<input onchange="updateProgress(this, true)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 25</span>
                                ‚≠ê‚≠ê‚≠ê Vis√£o geral do abrigo (interno)
                            </div>
<div class="photo-description">
<strong>FOTO AMPLA mostrando:</strong><br/>
                                ‚úì <strong>SEPARA√á√ÉO entre RSS e res√≠duo comum</strong> (CR√çTICO!)<br/>
                                ‚úì Piso imperme√°vel (cer√¢mica/cimento queimado)<br/>
                                ‚úì Paredes revestidas<br/>
                                ‚úì Organiza√ß√£o geral<br/>
                                ‚úì Limpeza do ambiente<br/>
                                ‚úì Recipientes fechados (bombonas/sacos)
                            </div>
<div class="photo-tips">
                                üí° Dica: Tire de cima para baixo (pega mais √°rea). Acenda TODAS as luzes! Foto n√£o pode ficar escura!
                            </div>
<div class="critical-note">
<strong>PONTOS CR√çTICOS DE AN√ÅLISE:</strong><br/>
                                ‚Ä¢ H√° separa√ß√£o CLARA entre RSS e comum? (obrigat√≥rio!)<br/>
                                ‚Ä¢ Piso √© lav√°vel? Est√° limpo?<br/>
                                ‚Ä¢ H√° presen√ßa de vetores (mosquitos, baratas, ratos)? (se houver = grave!)<br/>
                                ‚Ä¢ Recipientes est√£o fechados? (obrigat√≥rio!)
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<div class="photo-item">
<input onchange="updateProgress(this, true)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 26</span>
                                ‚≠ê Detalhes do piso e drenagem
                            </div>
<div class="photo-description">
                                ‚úì Piso imperme√°vel (cer√¢mica/cimento queimado)<br/>
                                ‚úì Ralo sifonado (se vis√≠vel)<br/>
                                ‚úì Canaletas de escoamento<br/>
                                ‚úì Declividade (se poss√≠vel observar)
                            </div>
<div class="photo-tips">
                                üí° Dica: Foto do ch√£o mostrando tipo de piso e sistema de drenagem
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<div class="photo-item">
<input onchange="updateProgress(this, true)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 27</span>
                                ‚≠ê‚≠ê Ventila√ß√£o e tela de prote√ß√£o
                            </div>
<div class="photo-description">
<strong>MUITO IMPORTANTE:</strong><br/>
                                ‚úì Abertura para ventila√ß√£o natural<br/>
                                ‚úì <strong>TELA de prote√ß√£o contra insetos e roedores</strong> (OBRIGAT√ìRIO!)<br/>
                                ‚úì Verificar se tela est√° √çNTEGRA (sem rasgos ou furos)
                            </div>
<div class="photo-tips">
                                üí° Dica: Close na abertura mostrando tela claramente. Verifique visualmente se h√° rasgos!
                            </div>
<div class="alert-danger">
<strong>N√ÉO CONFORMIDADE GRAVE:</strong><br/>
                                ‚Ä¢ FALTA de tela = entrada de vetores = risco sanit√°rio!<br/>
                                ‚Ä¢ Tela rasgada/furada = mesma gravidade!<br/>
                                Se encontrar, fotografe (prova) e RECOMENDE CORRE√á√ÉO URGENTE!
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<div class="photo-item">
<input onchange="updateProgress(this, true)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 28</span>
                                ‚≠ê Porta espec√≠fica para RSS
                            </div>
<div class="photo-description">
                                ‚úì Porta/√°rea com s√≠mbolo de risco biol√≥gico ‚ò£Ô∏è<br/>
                                ‚úì Identifica√ß√£o "GRUPO A", "RSS" ou "INFECTANTE"<br/>
                                ‚úì Separa√ß√£o visual da √°rea de res√≠duo comum
                            </div>
<div class="photo-tips">
                                üí° Dica: Mostrar que h√° segrega√ß√£o no abrigo externo tamb√©m
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 29</span>
                                Ponto de √°gua para higieniza√ß√£o
                            </div>
<div class="photo-description">
                                ‚úì Torneira/mangueira para limpeza<br/>
                                ‚úì √Årea para lavagem dos coletores<br/>
                                ‚úì Ponto de √°gua funcional
                            </div>
<div class="photo-tips">
                                üí° Dica: Mostrar que √© poss√≠vel higienizar os recipientes no local
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<textarea class="notes-area" placeholder="üìù NOTAS CR√çTICAS DO ABRIGO: Separa√ß√£o RSS/comum clara? Tela √≠ntegra? Presen√ßa de vetores? Limpeza? Piso imperme√°vel? Recipientes fechados? Observa√ß√µes importantes..."></textarea>
</div>

</div>
</section><section class="section" data-section-id="sec-10">
<button class="section__header" type="button" aria-expanded="false" aria-controls="sec-10-content">
  <h2>üìÑ 10. DOCUMENTA√á√ÉO T√âCNICA 4 fotos</h2>
  <span class="chevron" aria-hidden="true">‚ñº</span>
</button>
<div id="sec-10-content" class="section__content" hidden>

<div class="critical-note">
<strong>‚ö†Ô∏è IMPORTANTE:</strong> Fotografe documentos completos e LEG√çVEIS. Verifique validades!
                </div>
<div class="subsection">
<h3>10.1. Certificados Obrigat√≥rios</h3>
<div class="photo-item">
<input onchange="updateProgress(this, true)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 30</span>
                                ‚≠ê Certificado de Higieniza√ß√£o do Reservat√≥rio
                            </div>
<div class="photo-description">
<strong>VERIFICAR NO CERTIFICADO:</strong><br/>
                                ‚úì Empresa: SANITIZAR<br/>
                                ‚úì Data da higieniza√ß√£o: Abril/2025<br/>
                                ‚úì <strong>Validade: 01/10/2025</strong><br/>
                                ‚úì Nome do estabelecimento correto<br/>
                                ‚úì Certificado completo e leg√≠vel
                            </div>
<div class="photo-tips">
                                üí° Dica: Tire de cima para baixo, sem sombras. Todas as informa√ß√µes devem ficar leg√≠veis
                            </div>
<div class="critical-note">
<strong>AN√ÅLISE:</strong> Certificado v√°lido at√© 01/10/2025. Se a visita for ap√≥s esta data = VENCIDO = n√£o conforme!
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<div class="photo-item">
<input onchange="updateProgress(this, true)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 31</span>
                                ‚≠ê Certificado de Controle de Pragas (Dedetiza√ß√£o)
                            </div>
<div class="photo-description">
<strong>VERIFICAR NO CERTIFICADO:</strong><br/>
                                ‚úì Empresa: T C de S Costa Dedetizadora<br/>
                                ‚úì Data da dedetiza√ß√£o: Abril/2025<br/>
                                ‚úì <strong>Validade: 08/10/2025</strong><br/>
                                ‚úì Certificado completo e leg√≠vel
                            </div>
<div class="photo-tips">
                                üí° Dica: Mesmo procedimento. Foto leg√≠vel de todo o certificado
                            </div>
<div class="critical-note">
<strong>AN√ÅLISE:</strong> Certificado v√°lido at√© 08/10/2025. Verificar se est√° dentro da validade na data da visita!
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
</div>
<div class="subsection">
<h3>10.2. Contratos de Coleta</h3>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 32</span>
                                Contrato NATUS Ambiental (RSS)
                            </div>
<div class="photo-description">
<strong>FOTOGRAFAR:</strong><br/>
                                ‚úì Primeira p√°gina/capa do contrato<br/>
                                ‚úì Nome: NATUS Ambiental LTDA<br/>
                                ‚úì Tipo de servi√ßo: Coleta de RSS (Grupos A e E)<br/>
                                ‚úì Periodicidade: MENSAL
                            </div>
<div class="photo-tips">
                                üí° Dica: N√£o precisa fotografar contrato inteiro, s√≥ primeira p√°gina identificando a empresa e servi√ßo
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<div class="photo-item">
<input onchange="updateProgress(this)" type="checkbox"/>
<div class="photo-details">
<div class="photo-title">
<span class="photo-number">FOTO 33</span>
                                Licen√ßa Ambiental da NATUS (se dispon√≠vel)
                            </div>
<div class="photo-description">
                                ‚úì C√≥pia da licen√ßa ambiental da empresa coletora<br/>
                                ‚úì Verificar validade<br/>
                                ‚úì CNPJ da empresa
                            </div>
<div class="photo-tips">
                                üí° Dica: Pergunte se t√™m c√≥pia da licen√ßa da NATUS. Se n√£o tiverem, anote no relat√≥rio "n√£o disponibilizado"
                            </div>
<div class="photo-actions"><label class="btn btn-ghost">üì∑ Adicionar foto<input accept="image/*" capture="environment" class="file-input" hidden="True" multiple="True" type="file"/></label></div><ul aria-label="Galeria de fotos" class="thumbs"></ul></div>
</div>
<textarea class="notes-area" placeholder="üìù Notas: Certificados dentro da validade? Falta algum documento? Observa√ß√µes..."></textarea>
</div>

</div>
</section>
  </main>

  <footer class="app-footer">
    <p><strong>Checklist Interativo ‚Äî Relat√≥rio Fotogr√°fico RSS</strong></p>
    <p>RDC ANVISA 222/2018 ‚Ä¢ CONAMA 358/2005 ‚Ä¢ IN SEMAM Teresina 001/2024</p>
    <small>As marca√ß√µes e fotos s√£o salvas localmente no dispositivo.</small>
  </footer>

  <script type="module">
// === db.js ===
const DB_NAME='pgrss-photos'; const DB_VER=1; const STORE='photos'; let _db;
function openDB(){return new Promise((res,rej)=>{ if(_db) return res(_db); const req=indexedDB.open(DB_NAME,DB_VER);
  req.onupgradeneeded=(e)=>{const db=e.target.result; if(!db.objectStoreNames.contains(STORE)){db.createObjectStore(STORE);} };
  req.onsuccess=(e)=>{_db=e.target.result; res(_db)}; req.onerror=()=>rej(req.error); });}
async function putPhoto(id, blob){ const db=await openDB(); return new Promise((res,rej)=>{ const tx=db.transaction(STORE,'readwrite'); tx.objectStore(STORE).put(blob,id); tx.oncomplete=()=>res(); tx.onerror=()=>rej(tx.error); });}
async function getPhoto(id){ const db=await openDB(); return new Promise((res,rej)=>{ const tx=db.transaction(STORE,'readonly'); const req=tx.objectStore(STORE).get(id); req.onsuccess=()=>res(req.result||null); req.onerror=()=>rej(req.error); });}
async function deletePhoto(id){ const db=await openDB(); return new Promise((res,rej)=>{ const tx=db.transaction(STORE,'readwrite'); tx.objectStore(STORE).delete(id); tx.oncomplete=()=>res(); tx.onerror=()=>rej(tx.error); });}
async function getAllKeys(){ const db=await openDB(); return new Promise((res,rej)=>{ const tx=db.transaction(STORE,'readonly'); const req=tx.objectStore(STORE).getAllKeys(); req.onsuccess=()=>res(req.result||[]); req.onerror=()=>rej(req.error); });}
async function clearAll(){ const db=await openDB(); return new Promise((res,rej)=>{ const tx=db.transaction(STORE,'readwrite'); tx.objectStore(STORE).clear(); tx.oncomplete=()=>res(); tx.onerror=()=>rej(tx.error); });}

const DB = { putPhoto, getPhoto, deletePhoto, getAllKeys, clearAll };

// === state.js ===
const LS_CHECKS='pgrss-checks'; const LS_NOTES='pgrss-notes'; const LS_META='pgrss-photos-meta';
const q=(s,r=document)=>r.querySelector(s); const qa=(s,r=document)=>Array.from(r.querySelectorAll(s));
function clearAll(){ localStorage.removeItem(LS_CHECKS); localStorage.removeItem(LS_NOTES); localStorage.removeItem(LS_META); }
function getChecks(){ try{return JSON.parse(localStorage.getItem(LS_CHECKS))||{}}catch{return {}} }
function getNotes(){  try{return JSON.parse(localStorage.getItem(LS_NOTES)) ||[]}catch{return []} }
function getMeta(){   try{return JSON.parse(localStorage.getItem(LS_META))  ||{}}catch{return {}} }
function saveChecks(d){ localStorage.setItem(LS_CHECKS, JSON.stringify(d)); }
function saveNotes(d){  localStorage.setItem(LS_NOTES , JSON.stringify(d)); }
function saveMeta(d){   localStorage.setItem(LS_META  , JSON.stringify(d)); }
async function restoreAll(DB){
  const checks=getChecks();
  qa('.photo-item').forEach((it)=>{
    const id=it.dataset.itemId; const checked=checks[id]??false; const cb=it.querySelector('input[type=checkbox]');
    if (cb){ cb.checked=!!checked; it.classList.toggle('photo-item--checked', !!checked); }
  });
  const notes=getNotes(); qa('.notes-area').forEach((ta,idx)=>{ if(typeof notes[idx]==='string') ta.value=notes[idx]; });
}
function persistChecksFromDOM(){
  const obj={}; qa('.photo-item').forEach((it)=>{ const id=it.dataset.itemId; const cb=it.querySelector('input[type=checkbox]'); obj[id]=!!(cb&&cb.checked); });
  saveChecks(obj);
}
function persistNotesFromDOM(){ const arr=qa('.notes-area').map(ta=>ta.value); saveNotes(arr); }
function getItemMeta(itemId){ const all=getMeta(); return all[itemId] || { photoIds:[], captions:{}, order:[] }; }
function setItemMeta(itemId, meta){ const all=getMeta(); all[itemId]=meta; saveMeta(all); }
async function exportJSON(DB){
  const meta=getMeta(), checks=getChecks(), notes=getNotes();
  const keys=await DB.getAllKeys(); const hashes={};
  for (const key of keys){ const blob=await DB.getPhoto(key); if(!blob) continue; const hash=await blobHash(blob); hashes[key]=hash; }
  return { version:1, checks, notes, meta, hashes, exportedAt:new Date().toISOString() };
}
async function importJSON(data){
  if(!data || data.version!==1) throw new Error('Arquivo de backup inv√°lido.');
  saveChecks(data.checks||{}); saveNotes(data.notes||[]); saveMeta(data.meta||{});
}
async function blobHash(blob){ const buf=await blob.arrayBuffer(); const dig=await crypto.subtle.digest('SHA-256', buf); return [...new Uint8Array(dig)].map(b=>b.toString(16).padStart(2,'0')).join(''); }

const ST = { clearAll, getChecks, getNotes, getMeta, saveChecks, saveNotes, saveMeta, restoreAll, persistChecksFromDOM, persistNotesFromDOM, getItemMeta, setItemMeta, exportJSON, importJSON };

// === photos.js ===
import * as DB from './db.js'; import * as ST from './state.js';
const qa=(s,r=document)=>Array.from(r.querySelectorAll(s)); const q=(s,r=document)=>r.querySelector(s);
async function restoreAllGalleries(DBref, STref){ for (const item of qa('.photo-item')){ await renderGalleryForItem(item); } }
async function renderGalleryForItem(itemEl){
  const itemId=itemEl.dataset.itemId; const meta=ST.getItemMeta(itemId); const list=ensureThumbList(itemEl); list.innerHTML='';
  for (const id of meta.order){ await appendThumb(list, itemId, id, meta); }
}
function installFileInputHandler(itemEl){
  const input=ensureFileInput(itemEl);
  input.addEventListener('change', async (e)=>{
    const files=Array.from(e.target.files||[]); if(!files.length) return;
    for (const f of files){
      const {blob}=await compressImage(f);
      const pid=`${itemEl.dataset.itemId}-${crypto.randomUUID()}`;
      await DB.putPhoto(pid, blob);
      const meta=ST.getItemMeta(itemEl.dataset.itemId);
      if(!meta.photoIds.includes(pid)) meta.photoIds.push(pid);
      meta.order.push(pid); meta.captions[pid]=''; ST.setItemMeta(itemEl.dataset.itemId, meta);
    }
    await renderGalleryForItem(itemEl); toast('Foto(s) adicionada(s).');
  }, {once:false});
}
function ensureFileInput(itemEl){
  let input=q('.file-input', itemEl);
  if(!input){
    const actions = q('.photo-actions', itemEl) || (()=>{ const d=document.createElement('div'); d.className='photo-actions'; itemEl.appendChild(d); return d; })();
    const label=document.createElement('label'); label.className='btn btn-ghost'; label.textContent='üì∑ Adicionar foto';
    input=document.createElement('input'); input.type='file'; input.accept='image/*'; input.setAttribute('capture','environment'); input.multiple=true; input.hidden=true; input.className='file-input';
    label.appendChild(input); actions.appendChild(label);
  }
  return input;
}
function ensureThumbList(itemEl){
  let ul=q('.thumbs', itemEl);
  if(!ul){ ul=document.createElement('ul'); ul.className='thumbs'; ul.setAttribute('aria-label','Galeria de fotos'); itemEl.appendChild(ul); }
  return ul;
}
async function compressImage(file){
  const maxSide=1600, quality=0.7; const orientation=await readExifOrientation(file).catch(()=>1);
  const bmp=await createImageBitmap(file); const {w,h}=fitSize(bmp.width,bmp.height,maxSide);
  const canvas=new OffscreenCanvas(w,h); const ctx=canvas.getContext('2d',{alpha:false});
  applyOrientation(ctx, orientation, w, h); ctx.drawImage(bmp,0,0,w,h);
  const blob=await canvas.convertToBlob({type:'image/jpeg',quality}); return {blob,width:w,height:h};
}
function fitSize(w,h,max){ const s=Math.min(1, max/Math.max(w,h)); return {w:Math.round(w*s), h:Math.round(h*s)} }
function applyOrientation(ctx,o,w,h){ switch(o){ case 2: ctx.translate(w,0); ctx.scale(-1,1); break; case 3: ctx.translate(w,h); ctx.rotate(Math.PI); break; case 4: ctx.translate(0,h); ctx.scale(1,-1); break; case 5: ctx.rotate(.5*Math.PI); ctx.scale(1,-1); ctx.translate(0,-w); break; case 6: ctx.rotate(.5*Math.PI); ctx.translate(0,-w); break; case 7: ctx.rotate(.5*Math.PI); ctx.translate(h,-w); ctx.scale(-1,1); break; case 8: ctx.rotate(-.5*Math.PI); ctx.translate(-h,0); break; default: break; } }
async function readExifOrientation(file){
  const buf=await file.arrayBuffer(); const view=new DataView(buf); if(view.getUint16(0,false)!==0xFFD8) return 1;
  let off=2; const len=view.byteLength;
  while(off<len){ const marker=view.getUint16(off,false); off+=2;
    if(marker===0xFFE1){ const exifLen=view.getUint16(off,false); off+=2; const exif=new DataView(buf,off,exifLen);
      // Simplified search for tag 0x0112
      for (let i=8;i<exif.byteLength-2;i++){ if(exif.getUint16(i,false)===0x0112){ const val=exif.getUint16(i+8,false); return val||1; } } return 1;
    } else if((marker & 0xFF00)!==0xFF00){ break; } else { off+=view.getUint16(off,false); }
  } return 1;
}
async function appendThumb(listEl,itemId,photoId,meta){
  const li=document.createElement('li'); li.className='thumb'; li.setAttribute('draggable','true'); li.dataset.photoId=photoId;
  const blob=await DB.getPhoto(photoId); const url=blob?URL.createObjectURL(blob):'';
  li.innerHTML=`
    <img class="thumb__img" alt="Miniatura ‚Äî ${meta.captions[photoId]||''}" src="${url}">
    <div class="thumb__caption"><input type="text" placeholder="Legenda..." value="${meta.captions[photoId]||''}" aria-label="Legenda da foto"></div>
    <div class="thumb__buttons">
      <button class="icon-btn" data-act="view" aria-label="Ver foto">üëÅÔ∏è</button>
      <a class="icon-btn" data-act="dl" aria-label="Baixar foto" download="foto.jpg" href="${url}">‚¨áÔ∏è</a>
      <button class="icon-btn icon-btn--danger" data-act="remove" aria-label="Remover foto">üóëÔ∏è</button>
    </div>`;
  let t; li.querySelector('input')?.addEventListener('input',(e)=>{ clearTimeout(t); t=setTimeout(()=>{ const m=ST.getItemMeta(itemId); m.captions[photoId]=e.target.value||''; ST.setItemMeta(itemId,m); },250); });
  li.addEventListener('click',(e)=>{ const act=e.target?.dataset?.act; if(!act) return;
    if(act==='view'){ const w=window.open('','_blank'); w?.document.write(`<img src="${url}" style="max-width:100%;height:auto;display:block;margin:0 auto"/>`); }
    else if(act==='remove'){ confirm('Remover esta foto?') && removePhoto(itemId, photoId, li); }
  });
  li.addEventListener('dragstart',(e)=>{ e.dataTransfer.setData('text/plain', photoId); });
  listEl.addEventListener('dragover',(e)=>{ e.preventDefault(); });
  listEl.addEventListener('drop',(e)=>{ e.preventDefault(); const draggedId=e.dataTransfer.getData('text/plain'); const target=e.target.closest('.thumb'); if(!target||!draggedId)return; const targetId=target.dataset.photoId; reorder(itemId, draggedId, targetId); renderGalleryForItem(listEl.closest('.photo-item')); });
  listEl.appendChild(li);
}
async function removePhoto(itemId,photoId,li){
  await DB.deletePhoto(photoId);
  const meta=ST.getItemMeta(itemId);
  meta.photoIds=meta.photoIds.filter(id=>id!==photoId);
  meta.order=meta.order.filter(id=>id!==photoId);
  delete meta.captions[photoId];
  ST.setItemMeta(itemId, meta);
  li.remove();
}
function reorder(itemId,draggedId,targetId){
  const meta=ST.getItemMeta(itemId); const arr=meta.order.slice(); const from=arr.indexOf(draggedId); const to=arr.indexOf(targetId);
  if(from<0||to<0) return; arr.splice(from,1); arr.splice(to,0,draggedId); meta.order=arr; ST.setItemMeta(itemId, meta);
}
function toast(msg){ const el=document.createElement('div'); el.className='toast'; el.textContent=msg; document.body.appendChild(el); setTimeout(()=>{ el.remove(); },2200); }


const PH = { restoreAllGalleries, renderGalleryForItem, installFileInputHandler, compressImage, toast };

// === ui.js ===
import * as ST from './state.js'; import * as PH from './photos.js';
const qa=(s,r=document)=>Array.from(r.querySelectorAll(s)); const q=(s,r=document)=>r.querySelector(s);
function toast(msg){ PH.toast(msg); }
function assignStableItemIds(){
  const seen=new Set();
  qa('.photo-item').forEach((it, idx)=>{
    let label = it.querySelector('.photo-title')?.textContent || '';
    let id=''; const m = label.match(/FOTO\s*(\d+)/i);
    if(m) id=`item-${String(m[1]).padStart(2,'0')}`; else id=`item-auto-${idx+1}`;
    while(seen.has(id)) id=`${id}-x`; seen.add(id);
    it.dataset.itemId=id;
    // Ensure upload UI and handlers
    PH.installFileInputHandler(it);
  });
  const total = qa('.photo-item').length;
  const stat = q('#statItems'); if (stat) stat.textContent = String(total);
}
function installDelegatedHandlers(DB, ST, PH){
  document.addEventListener('change',(e)=>{
    const cb = e.target.closest('.photo-check__box, .photo-item input[type=checkbox]');
    if (cb){
      const item=e.target.closest('.photo-item');
      if (item){ item.classList.toggle('photo-item--checked', e.target.checked); ST.persistChecksFromDOM(); refreshProgress(ST); }
    }
  });
  document.addEventListener('input',(e)=>{ if (e.target.classList.contains('notes-area')){ ST.persistNotesFromDOM(); } });
}
function refreshProgress(STref){
  const checks=STref.getChecks();
  const cbs=qa('.photo-item input[type=checkbox]');
  const total=cbs.length; const checked=cbs.filter(cb=>cb.checked).length;
  const crit=cbs.filter(cb=>{ const title=cb.closest('.photo-item')?.querySelector('.photo-title')?.textContent||''; return title.includes('‚≠ê'); });
  const critChecked=crit.filter(cb=>cb.checked).length;
  const perc = total ? Math.round(checked/total*100) : 0;
  const fill=q('#progressFill'); if (fill){ fill.style.width=`${perc}%`; fill.textContent=`${perc}%`; }
  const sp=q('#statPhotos'); if (sp) sp.textContent=String(checked);
  const sc=q('#statCritical'); if (sc) sc.textContent=`${critChecked}/${crit.length}`;
}
function expandAll(){
  qa('.section__header').forEach(btn=>{ const id=btn.getAttribute('aria-controls'); const panel=document.getElementById(id); if(panel){ btn.setAttribute('aria-expanded','true'); panel.hidden=false; const ch=q('.chevron', btn); if(ch) ch.style.transform='rotate(180deg)'; }});
}
function collapseAll(){
  qa('.section__header').forEach(btn=>{ const id=btn.getAttribute('aria-controls'); const panel=document.getElementById(id); if(panel){ btn.setAttribute('aria-expanded','false'); panel.hidden=true; const ch=q('.chevron', btn); if(ch) ch.style.transform='rotate(0deg)'; }});
}
function installSectionToggles(){
  qa('.section__header').forEach(btn=>{
    btn.addEventListener('click',()=>{ const exp=btn.getAttribute('aria-expanded')==='true'; const id=btn.getAttribute('aria-controls'); const panel=document.getElementById(id); btn.setAttribute('aria-expanded', String(!exp)); if(panel) panel.hidden=exp; const ch=q('.chevron', btn); if(ch) ch.style.transform=exp?'rotate(0deg)':'rotate(180deg)'; });
    btn.addEventListener('keydown',(e)=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); btn.click(); } });
  });
}

const UI = { toast, assignStableItemIds, installDelegatedHandlers, refreshProgress, expandAll, collapseAll, installSectionToggles };

// === bootstrap ===
window.addEventListener('DOMContentLoaded', async () => {
  UI.assignStableItemIds();
  await ST.restoreAll(DB);
  await PH.restoreAllGalleries(DB, ST);
  UI.refreshProgress(ST);
  document.getElementById('btnExpandAll').addEventListener('click', UI.expandAll);
  document.getElementById('btnCollapseAll').addEventListener('click', UI.collapseAll);
  document.getElementById('btnPrint').addEventListener('click', () => window.print());
  document.getElementById('btnClear').addEventListener('click', async () => {
    if (confirm('Limpar todos os dados (metadados + fotos)?')) { await DB.clearAll(); ST.clearAll(); location.reload(); }
  });
  document.getElementById('btnExport').addEventListener('click', async () => {
    const data = await ST.exportJSON(DB);
    const blob = new Blob([JSON.stringify(data, null, 2)], {type:'application/json'});
    const url = URL.createObjectURL(blob);
    const a = Object.assign(document.createElement('a'), { href:url, download:'pgrss-backup.json' });
    document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
  });
  document.getElementById('importInput').addEventListener('change', async (e) => {
    const f = e.target.files?.[0]; if (!f) return;
    const txt = await f.text(); const data = JSON.parse(txt);
    await ST.importJSON(data); await PH.restoreAllGalleries(DB, ST);
    UI.refreshProgress(ST); UI.toast('Backup importado com sucesso.');
  });
  UI.installDelegatedHandlers();
  UI.installSectionToggles();
});
</script>

</body>
</html>
